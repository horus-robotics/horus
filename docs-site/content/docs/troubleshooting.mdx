---
title: Troubleshooting & Maintenance
description: Fix installation issues, update HORUS, and verify installation health
order: 13
---

# Troubleshooting & Maintenance

HORUS includes utility scripts to help you update, recover from broken installations, and verify your setup.

## Quick Reference

| Script | Use When | What It Does |
|--------|----------|--------------|
| `./update.sh` | Update to latest version | Smart incremental update (auto git pull) |
| `./verify.sh` | Check installation health | Diagnose issues, verify setup |
| `./recovery_install.sh` | Build errors, corrupted cache | Nuclear option: fresh rebuild |
| `./install.sh` | First time installation | Full installation from source |
| `./uninstall.sh` | Remove HORUS | Complete removal |

---

## update.sh - Smart Updates

**Use when:** You want to update to the latest version

### Quick Usage

```bash
cd /path/to/HORUS
./update.sh  # Automatically pulls latest changes
```

### What It Does

1. **Safety checks**: Detects uncommitted changes, offers to stash
2. **Git update**: Shows what changed, pulls latest commits
3. **Smart detection**: Only rebuilds what's necessary
4. **Dependency update**: Updates Cargo.toml if needed
5. **Verification**: Quick smoke test after update

### Example Session

```bash
$ ./update.sh
 HORUS Update Script

 Current version: 0.1.0

 Fetching latest changes from remote...
 Updates available on main

Recent changes:
  * a1b2c3d Fix edge detection bug
  * d4e5f6g Add ONNX runtime support
  * g7h8i9j Update dependencies

Pull and update? [Y/n]: y

 Pulling latest changes...
 Updated to latest commit

 Analyzing changes...
 Cargo.toml files changed - dependencies may have updated
 Rust source files changed

 Updating dependencies...
 Dependencies updated

 Rebuilding HORUS (release mode)...
   Compiling horus_core v0.1.3
   Compiling horus v0.1.3
 Build completed

 Installing updated binary...
 Binary installed to ~/.cargo/bin/horus

 Updating library cache...
 Libraries updated

 Verifying update...
 New version: 0.1.3
 Smoke test passed

 Update complete!

Version: 0.1.0  0.1.3
```

### Options

**Handle uncommitted changes:**
```bash
  Warning: You have uncommitted changes

 M horus_core/src/scheduler.rs
 M docs/readme.md

? Stash changes before updating? [y/N]: y
 Changes stashed
```

**Rebuild even if up-to-date:**
```bash
 Already up to date

? Rebuild anyway? [y/N]: y
```

### Troubleshooting update.sh

**Error: Not in a git repository**
- Make sure you're in the HORUS repository root
- Run: `git status` to verify

**Build failed during update**
- Try: `./recovery_install.sh` for fresh rebuild
- Check error messages above
- Verify dependencies: `./verify.sh`

---

## verify.sh - Installation Health Check

**Use when:** Diagnosing issues, checking if installation is correct

### Quick Usage

```bash
./verify.sh
```

### What It Checks

1. **System Requirements**
   - Rust version (&gt;= 1.70)
   - Cargo installation
   - C compiler
   - pkg-config
   - System libraries (OpenSSL, udev)

2. **HORUS Installation**
   - Binary location and version
   - PATH configuration
   - Core libraries
   - Optional components (Python/C++ bindings)

3. **Functionality Tests**
   - Commands work (`--version`, `--help`)
   - All subcommands accessible (`new`, `run`, `dashboard`, `pkg`, `env`, `auth`, `version`)
   - **Build verification** (when run in HORUS repo):
     - `cargo check` passes without errors
     - Zero warnings in codebase
     - Debug binary is functional

4. **Disk Usage**
   - Cache sizes
   - Installation footprint

### Example Output

```bash

   HORUS Installation Verification


System Requirements:

   Rust: 1.75.0 (>= 1.70 required)
   Cargo: 1.75.0
   C compiler: GCC
   pkg-config: 0.29.2

System Libraries:

   OpenSSL: 3.0.2
   udev: Not found (optional for some features)

HORUS Installation:

   Binary: v0.1.0 at ~/.cargo/bin/horus
   In PATH: Yes (correct binary)

Core Libraries:

   Installed version: 0.1.0
   Main library: v0.1.0
   Runtime core: v0.1.0
   Proc macros: v0.1.0
   Standard library: v0.1.0
   C++ bindings: Not installed (optional)
   Python bindings: Not installed (optional)

Functionality Tests:

   Command: --help
   All subcommands: Accessible

   Running build verification...
   Build: cargo check passes (0 warnings)
   Binary: Debug build functional

Disk Usage:

   ~/.horus: 45M
   Library cache: 42M
   Cargo cache: 2.3G


Summary:

   Perfect! Everything looks good.

  HORUS is properly installed and ready to use.

```

### Exit Codes

Useful for CI/CD:

```bash
./verify.sh
EXIT_CODE=$?

if [ $EXIT_CODE -eq 0 ]; then
    echo "All good!"
elif [ $EXIT_CODE -eq 1 ]; then
    echo "Warnings found"
else
    echo "Errors found"
fi
```

- **0** = Perfect, no issues
- **1** = Warnings (minor issues)
- **2** = Errors (installation broken)

### Common Warnings

**Binary not in PATH:**
```bash
 'horus' command not found in PATH
  Add to shell profile (~/.bashrc, ~/.zshrc, etc.):
  export PATH="$HOME/.cargo/bin:$PATH"
```

**Old Rust version:**
```bash
 Rust: 1.65.0 (< 1.70, please update)
  Update with: rustup update
```

**Missing optional libraries:**
```bash
 udev: Not found (optional for some features)
  Ubuntu/Debian: sudo apt install libudev-dev
  Fedora: sudo dnf install systemd-devel
```

---

## recovery_install.sh - Nuclear Recovery

**Use when:** Build errors, corrupted cache, installation broken

### Quick Usage

```bash
./recovery_install.sh
```

### What It Does

**Phase 1: Comprehensive Diagnostics**
- Checks 30+ system requirements
- Detects missing dependencies
- Finds version conflicts
- Reports all issues clearly

**Phase 2: Deep Cleanup**
- Removes all build artifacts (`target/`)
- Cleans HORUS from cargo cache
- Removes old binaries
- Optionally cleans `~/.horus/cache`

**Phase 3: Fresh Installation**
- Runs `install.sh` from scratch
- Clean build in release mode
- Fresh library installation

**Phase 4: Verification**
- Tests binary works
- Verifies all libraries installed
- Checks PATH configuration

### Example Session

```bash
$ ./recovery_install.sh
 HORUS Recovery Installation Script


This script will:
  • Detect system dependencies and issues
  • Clean all build artifacts and caches
  • Fresh installation from scratch
  • Comprehensive verification

? Continue with recovery installation? [y/N]: y

 PHASE 1: System Diagnostics 

 Checking Rust toolchain...
   Rust: 1.75.0
   Cargo: 1.75.0

 Checking C compiler...
   C compiler: gcc (Ubuntu 11.4.0-1ubuntu1~22.04) 11.4.0

 Checking system dependencies...
   pkg-config: 0.29.2
   libopenssl: 3.0.2
   libudev: not found (optional)

 Checking for existing HORUS installations...
   Found existing binary: 0.1.0
   Multiple 'horus' commands found in PATH
      - /home/user/.cargo/bin/horus
      - /usr/local/bin/horus

 Diagnostic Summary 
  Errors:   0
  Warnings: 3

  Warnings found
You can continue, but some features may not work.

? Continue anyway? [y/N]: y

 PHASE 2: Cleanup 

 Cleaning build artifacts...
   Removing target/ (1.2G)...
   Build artifacts removed

 Cleaning HORUS from cargo cache...
   Cargo cache cleaned

? Remove ~/.horus/cache (installed libraries)? [Y/n]: y
   HORUS cache removed

? Remove ~/.horus/config (user settings)? [y/N]: n
   Keeping user config

   Old binary removed

 Cleanup complete

 PHASE 3: Fresh Installation 

 Running install.sh...

[... install.sh output ...]

 PHASE 4: Verification 

 Testing HORUS binary...
   Binary works: v0.1.0

 Testing basic commands...
   --help works

 Checking PATH...
   'horus' found in PATH
       ~/.cargo/bin/horus

 Checking installed libraries...
   Installed version: 0.1.0
   horus installed
   horus_core installed
   horus_macros installed
   horus_library installed

 Recovery installation successful!

Next steps:
  1. Test creating a project:
     horus new test_project

  2. Run it:
     cd test_project && horus run
```

### When to Use Recovery Install

**Symptoms requiring recovery:**

1. **Build fails:**
   ```
   error: could not compile `horus_core`
   ```

2. **Corrupted cache:**
   ```
   error: failed to load source for dependency `horus_core`
   ```

3. **Binary doesn't work:**
   ```bash
   $ horus --help
   Segmentation fault
   ```

4. **Version mismatches:**
   ```
   error: the package `horus` depends on `horus_core 0.1.0`,
   but `horus_core 0.1.3` is installed
   ```

5. **Broken after system updates:**
   - Rust updated
   - System libraries changed
   - GCC/Clang updated

### What Gets Removed

**Always removed:**
- `target/` directory (build artifacts)
- Old `~/.cargo/bin/horus` binary
- HORUS entries in `~/.cargo/registry`

**Ask before removing:**
- `~/.horus/cache` (installed libraries)
- `~/.horus/config` (user settings)

**Never removed:**
- Project-local `.horus/` directories
- `~/.horus/credentials` (registry auth)
- Your source code

---

## Common Issues & Solutions

### Installation Issues

**Problem: "Rust not installed"**

```bash
$ ./install.sh
 Error: Rust is not installed
```

**Solution:**
```bash
# Install Rust
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

# Then try again
./install.sh
```

---

**Problem: "C compiler not found"**

**Solution:**
```bash
# Ubuntu/Debian
sudo apt update && sudo apt install \
  build-essential \
  pkg-config \
  libudev-dev \
  libssl-dev \
  libasound2-dev

# Fedora/RHEL
sudo dnf groupinstall "Development Tools"
sudo dnf install pkg-config systemd-devel openssl-devel alsa-lib-devel
```

---

**Problem: Build fails with linker errors**

```
error: linking with `cc` failed: exit status: 1
```

**Solution:**
```bash
# Install missing system libraries
# Ubuntu/Debian
sudo apt update && sudo apt install \
  build-essential \
  pkg-config \
  libudev-dev \
  libssl-dev \
  libasound2-dev

# Or run recovery
./recovery_install.sh
```

---

### Update Issues

**Problem: "Build failed" during update**

**Solution:**
```bash
# Try recovery instead
./recovery_install.sh
```

---

**Problem: "Already up to date" but binary broken**

**Solution:**
```bash
# Force rebuild
./update.sh
# When asked "Rebuild anyway?", answer: y
```

---

### Runtime Issues

**Problem: "horus: command not found"**

**Solution:**
```bash
# Add to PATH (add to ~/.bashrc or ~/.zshrc)
export PATH="$HOME/.cargo/bin:$PATH"

# Then reload shell
source ~/.bashrc  # or restart terminal

# Verify
which horus
horus --help
```

---

**Problem: Binary exists but doesn't run**

```bash
$ horus --help
Segmentation fault
```

**Solution:**
```bash
# Full recovery
./recovery_install.sh
```

---

**Problem: Version mismatch errors**

```
error: the package `horus` depends on `horus_core 0.1.0`,
but `horus_core 0.1.3` is installed
```

**Solution:**
```bash
# Recovery will clean mismatched versions
./recovery_install.sh
```

---

**Problem: "HORUS source directory not found" (Rust projects)**

```
Error: HORUS source directory not found. Please set HORUS_SOURCE environment variable.
```

**Solution:**
```bash
# Option 1: Set HORUS_SOURCE (recommended for non-standard installations)
export HORUS_SOURCE=/path/to/HORUS
echo 'export HORUS_SOURCE=/path/to/HORUS' >> ~/.bashrc

# Option 2: Install HORUS to a standard location
# The CLI checks these paths automatically:
#   - ~/horus/HORUS
#   - /horus
#   - /opt/horus
#   - /usr/local/horus

# Verify HORUS source is found
horus run --build-only
```

**Why this happens:**
- `horus run` needs to find HORUS core libraries for Rust compilation
- It auto-detects standard installation paths
- For custom installations, set `$HORUS_SOURCE`

---

### Performance Issues

**Problem: Slow builds**

**Solution:**
```bash
# Use release mode (optimized)
horus run --release

# Or configure in horus.yaml
mode: release
```

---

**Problem: Large disk usage**

**Solution:**
```bash
# Check usage
./verify.sh

# Clean old cargo cache
cargo clean

# Remove unused dependencies
cargo install cargo-cache
cargo cache --autoclean
```

---

**Problem: Large `.horus/target/` directory (Rust projects)**

**Why this happens:**
- Cargo stores build artifacts in `.horus/target/`
- Debug builds are unoptimized and larger
- Incremental compilation caches intermediate files

**Solution:**
```bash
# Clean build artifacts in current project
rm -rf .horus/target/

# Or use horus clean flag (next build will be slower)
horus run --clean

# Regular cleanup (if working on multiple projects)
find . -type d -name ".horus" -exec rm -rf {}/target/ \;

# Add to .gitignore (already included in horus new templates)
echo ".horus/target/" >> .gitignore
```

**Disk usage typical sizes:**
- `.horus/Cargo.toml`: ~266 bytes
- `.horus/target/debug/`: ~10-100 MB (incremental builds)
- `.horus/target/release/`: ~5-50 MB (optimized, no debug symbols)

**Best practices:**
- `.horus/target/` is in `.gitignore` by default
- Clean periodically if disk space is limited
- Only `.horus/Cargo.toml` and `.horus/Cargo.lock` are needed for rebuild

---

## Best Practices

### Regular Maintenance

**Weekly (active development):**
```bash
./update.sh  # Pulls latest and rebuilds
```

**Monthly:**
```bash
./verify.sh  # Check for warnings
```

**After system updates:**
```bash
./recovery_install.sh  # If Rust/GCC updated
```

### CI/CD Integration

```bash
# In CI pipeline
./verify.sh || ./recovery_install.sh

# Exit codes
if ./verify.sh; then
    echo "Installation OK"
else
    echo "Installation has issues, check logs"
    exit 1
fi
```

### Debugging Workflow

1. **First: Verify installation**
   ```bash
   ./verify.sh
   ```

2. **If warnings: Update**
   ```bash
   ./update.sh
   ```

3. **If errors: Recovery**
   ```bash
   ./recovery_install.sh
   ```

4. **Still broken: Report issue**
   ```bash
   ./verify.sh > diagnostic.txt
   # Attach diagnostic.txt to issue report
   ```

---

## Getting Help

If you encounter issues:

1. **Run diagnostics:**
   ```bash
   ./verify.sh > diagnostic.txt
   ```

2. **Try recovery:**
   ```bash
   ./recovery_install.sh
   ```

3. **Check common issues** (above)

4. **Report the issue:**
   - Include output from `verify.sh`
   - Describe what you were doing
   - System info (OS, Rust version)
   - GitHub: https://github.com/your-org/horus/issues

---

## Runtime Errors

Common errors when running HORUS applications and how to fix them.

### Hub Creation Failed

**Symptom:**
```rust
Error: Failed to create Hub
thread 'main' panicked at 'Hub::new() failed'
```

**Cause:**
- Insufficient permissions on `/dev/shm`
- Disk space full on `/dev/shm`
- Topic name contains invalid characters

**Fix:**

```bash
# Check /dev/shm permissions
ls -la /dev/shm

# Check available space
df -h /dev/shm

# Clean old HORUS shared memory
rm -f /dev/shm/horus_*

# Fix permissions (if needed)
sudo chmod 1777 /dev/shm
```

**Code Fix:**
```rust
// Ensure topic names are valid (alphanumeric, underscore, slash)
// Good:
let hub = Hub::new("sensor_data")?;
let hub = Hub::new("robot/cmd_vel")?;

// Bad (will fail):
let hub = Hub::new("sensor data")?;  // Space
let hub = Hub::new("temp@sensor")?;  // Special char
```

---

### Topic Not Found / No Messages Received

**Symptom:**
```rust
// Subscriber never receives messages
if let Some(data) = self.data_sub.recv(ctx) {
    println!("Got data");  // Never prints
}
```

**Cause:**
- Publisher and subscriber use different topic names (typo)
- Publisher hasn't sent any messages yet
- Nodes running in different processes without shared memory

**Fix:**

**1. Verify Topic Names Match:**
```rust
// Publisher
let pub_hub = Hub::new("temperature")?;  // Note: "temperature"

// Subscriber (wrong - typo!)
let sub_hub = Hub::new("temperatur")?;   // Missing 'e'

// Fixed:
let sub_hub = Hub::new("temperature")?;  // Now matches!
```

**2. Check Publishing is Happening:**
```rust
// Add logging to publisher
fn tick(&mut self, mut ctx: Option<&mut NodeInfo>) {
    let data = 42.0;
    match self.pub_hub.send(data, ctx) {
        Ok(()) => {
        ctx.log_info("Published successfully");
        }
        Err(_) => {
        ctx.log_error("Publish failed!");
        }
    }
}
```

**3. Use Dashboard to Debug:**
```bash
# Terminal 1: Run your app
horus run

# Terminal 2: Open dashboard
horus dashboard
```

In dashboard:
- **Topics tab**: Shows all active topics and their types
- **Nodes tab**: Shows which nodes are publishing/subscribing
- **Metrics tab**: Shows message counts (0 = no messages)

**4. Check Node Priority:**

Ensure publisher runs before subscriber:
```rust
let mut scheduler = Scheduler::new();

// Publisher (priority 0 - runs first)
scheduler.add(Box::new(publisher), 0, Some(true));

// Subscriber (priority 1 - runs after)
scheduler.add(Box::new(subscriber), 1, Some(true));
```

---

### Application Hangs / Deadlock

**Symptom:**
```
Starting application...
[Nodes initialized]
[Application freezes - no output]
```

**Cause:**
- Infinite loop in `tick()` method
- Blocking I/O operation
- Waiting for message that never arrives

**Fix:**

**1. Check for Infinite Loops:**
```rust
// BAD: Infinite loop in tick
fn tick(&mut self, mut ctx: Option<&mut NodeInfo>) {
    loop {  // Never returns!
        // Process data
    }
}

// GOOD: Tick returns after work
fn tick(&mut self, mut ctx: Option<&mut NodeInfo>) {
    // Do work once
    self.process_data();
    // Return naturally
}
```

**2. Avoid Blocking Operations:**
```rust
// BAD: Blocking sleep in tick
fn tick(&mut self, mut ctx: Option<&mut NodeInfo>) {
    std::thread::sleep(Duration::from_secs(10));  // Blocks scheduler!
}

// GOOD: Use tick counter for delays
fn tick(&mut self, mut ctx: Option<&mut NodeInfo>) {
    self.tick_count += 1;

    // Execute every 10 ticks (~167ms at 60 FPS)
    if self.tick_count % 10 == 0 {
        self.slow_operation();
    }
}
```

**3. Don't Wait Forever for Messages:**
```rust
// BAD: Blocking wait
fn tick(&mut self, mut ctx: Option<&mut NodeInfo>) {
    while self.data_sub.recv(ctx).is_none() {
        // Infinite loop if no messages!
    }
}

// GOOD: Non-blocking receive
fn tick(&mut self, mut ctx: Option<&mut NodeInfo>) {
    if let Some(data) = self.data_sub.recv(ctx) {
        // Process data
    }
    // Continue even if no message
}
```

**4. Debug with Logging:**
```rust
fn tick(&mut self, mut ctx: Option<&mut NodeInfo>) {
        ctx.log_debug("Tick started");

    // Your code here
        ctx.log_debug("Tick completed");
}
```

If you see "Tick started" but never "Tick completed", the hang is in your code.

---

### Message Size Errors

**Symptom:**
```
Error: Message too large for shared memory
thread 'main' panicked at 'send() failed'
```

**Cause:**
- Message type is too large for shared memory buffer
- Trying to send very large arrays or strings

**Fix:**

**1. Check Message Size:**
```rust
use std::mem::size_of;

#[derive(Clone, Debug)]
struct LargeMessage {
    data: [f32; 100000],  // 400KB!
}

fn main() {
    println!("Message size: {} bytes", size_of::<LargeMessage>());
}
```

**2. Reduce Message Size:**
```rust
// BAD: Huge array
struct SensorData {
    readings: [f32; 100000],  // 400KB
}

// GOOD: Smaller, reasonable size
struct SensorData {
    readings: [f32; 100],  // 400 bytes
}
```

**3. Split Large Data:**
```rust
// Send data in chunks
for chunk in large_data.chunks(100) {
    let msg = ChunkMessage {
        data: chunk.to_vec(),
        index: i,
    };
    self.pub_hub.send(msg, ctx).ok();
}
```

**4. Use Arc for Large Data:**
```rust
use std::sync::Arc;

// Share large data without copying
type LargeData = Arc<Vec<f32>>;

let data = Arc::new(vec![0.0; 100000]);
self.pub_hub.send(Arc::clone(&data), ctx).ok();
```

---

### Using Dashboard to Debug

The dashboard is your best debugging tool for runtime issues.

**Starting the Dashboard:**
```bash
# Terminal 1: Run your application
horus run

# Terminal 2: Start dashboard
horus dashboard
```

**Dashboard Features:**

**1. Nodes Tab:**
- Shows all running nodes
- Displays node state (Running, Error, Stopped)
- Shows tick count and timing
- Highlights nodes that aren't ticking (stuck)

**2. Topics Tab:**
- Lists all active topics
- Shows message types
- Displays publisher/subscriber counts
- **0 publishers** = no one is sending
- **0 subscribers** = no one is listening

**3. Metrics Tab:**
- **IPC Latency**: Communication time (should be &lt;1µs)
- **Tick Duration**: How long each node takes
- **Message Counts**: Total sent/received
  - If sent > 0 but received = 0, subscriber issue
  - If sent = 0, publisher issue

**4. Graph Tab:**
- Visual node graph
- Shows message flow between nodes
- Disconnected nodes = topic mismatch

**Debug Workflow:**

```
1. Check Nodes tab
   -> All nodes Running? (If Error, check logs)

2. Check Topics tab
   -> Topics exist? (If no, topic name typo)
   -> Publishers > 0? (If no, publisher not working)
   -> Subscribers > 0? (If no, subscriber not created)

3. Check Metrics tab
   -> Messages sent > 0? (If no, publisher not sending)
   -> Messages received > 0? (If no, subscriber not receiving)
   -> IPC latency sane? (If >1ms, system issue)

4. Check Graph tab
   -> Nodes connected? (If no, topic name mismatch)
```

**Example Debug Session:**

```bash
# Problem: Subscriber not receiving messages

# Dashboard shows:
# Nodes: SensorNode (Running), DisplayNode (Running)
# Topics: "sensor_data" (1 pub, 0 sub)  <-- AHA!

# Issue: No subscribers!
# Fix: Check DisplayNode - likely wrong topic name
```

---

## Next Steps

- **[Installation](/getting-started/installation)** - First-time installation guide
- **[CLI Reference](/cli-reference)** - All horus commands
- **[Examples](/examples)** - Working code examples
- **[Performance](/performance)** - Optimization tips
- **[Testing](/testing)** - Test your nodes to prevent runtime errors
